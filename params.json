{
  "name": "UNDR ROVER",
  "tagline": "Unmapped primer directed ROVER",
  "body": "## UNDR ROVER - A fast and accurate variant caller for targeted DNA sequencing.\r\n\r\n### Authors:\r\n\r\n * Bernard J Pope (2,3)\r\n * TÃº Nguyen-Dumont (1)\r\n * Daniel J Park (1)\r\n * Roger Li (2)\r\n * Edmund Lau (2)\r\n * Peter Georgeson (2)\r\n\r\n1. Genetic Epidemiology Laboratory, Department of Pathology, The University of Melbourne.\r\n2. Victorian Life Sciences Computation Initiative (VLSCI).\r\n3. Department of Computing and Information Systems, The University of Melbourne.\r\n\r\n### License:\r\n\r\n[The BSD 3-Clause License](http://opensource.org/licenses/BSD-3-Clause)\r\n\r\n### Requirements\r\n\r\n  * Python 2.7\r\n  * [PyVCF](https://pypi.python.org/pypi/PyVCF)\r\n  * [Pyfaidx](https://pypi.python.org/pypi/pyfaidx)\r\n  * [Biopython](https://pypi.python.org/pypi/biopython)\r\n  * [SciPy](http://www.scipy.org/)\r\n  * A reference human genome sequence in a single FASTA file\r\n  * A file describing the amplicon target coordinates\r\n  * A file describing the PCR primers used for the specified coordinates\r\n  * Paired-end DNA sequences where the paired reads significantly overlap, such as the result of the [Hi-Plex targeted sequencing system](http://hiplex.org/).\r\n\r\n### Description\r\n\r\nUNDR ROVER enables the user to call variants from decompressed FASTQ files\r\ndirectly without having to go through a mapping step.\r\n\r\nReads are organised into blocks, which are initialised from information about\r\nknown primer sequences. For each block, we record the primer's DNA sequence,\r\ncoordinates and reference insert sequence. Once the reads have been assigned\r\nto blocks (by matching the bases in their primer region to a known primer),\r\nwe call variants for each block one at a time.\r\n\r\nThe approach UNDR ROVER takes when processing reads to call variants is to\r\ninitially assume that all reads contain only single nucleotide variants. If\r\nwe detect two single nucleotide variants in a row during this variant calling,\r\nUNDR ROVER immediatly ceases this step and instead does a full gapped alignment\r\nof the read against the reference insert sequence to detect possible insertions\r\nand deletions.\r\n\r\nOnly variants detected in both reads of a read-pair are considered relevant. This allows UNDR ROVER to filter out many sequencing artifacts and produce highly accurate results. However, it does depend on the underlying sequences to have substantially overlapping paired reads, such as the result of the [Hi-Plex targeted sequencing system](http://hiplex.org/).\r\nUser-defined thresholds determine the minimum number and proportion of\r\nread-pairs a variant must be observed to be considered a 'PASS'. Coverage is\r\nalso reported for each block to allow for regions which require additional\r\nscreening to be easily identified.\r\n\r\n### Installation\r\n\r\nWe recommend using virtualenv for installing UNDR ROVER in a sandboxed environment instead of a global install. The instructions below assume you are working in a directory where you can install the software.\r\n\r\nUNDR ROVER depends on SciPy, which can be challenging to install using pip. We recommend using your operating system package manner to install SciPy before installing UNDR ROVER. The `--system-site-packages` option to virtualenv tells pip to use the site-installed version of SciPy.\r\n\r\n```\r\nvirtualenv --system-site-packages undr_rover_dev\r\nsource undr_rover_dev/bin/activate\r\npip install git+https://github.com/bjpop/undr_rover\r\n```\r\n\r\nYou can test that the installation worked correctly by asking undr_rover for its version number:\r\n\r\n```\r\nundr_rover --version\r\nundr_rover 2.0.0\r\n```\r\n\r\n### The human genome reference\r\n\r\nUNDR ROVER requires a human reference genome in a single FASTA format. Your choice of which version to use will depend on other downstream analyses that you might do. HG19 works well if you don't know which one to choose.\r\n\r\nYou will need to index the reference genome to produce a `.fai` file. You can do this with samtools:\r\n\r\n```\r\nsamtools faidx reference.fasta\r\n```\r\n\r\n## Worked example\r\n\r\nThe source code of UNDR ROVER comes with a small example dataset for testing purposes.\r\n\r\n#### Obtain a copy of the UNDR ROVER source code:\r\n\r\n```\r\ngit clone https://github.com/bjpop/undr_rover\r\n```\r\n\r\nThe example data set is in the directory `undr_rover/example` within the source code.\r\n\r\n```\r\ncd undr_rover/example/\r\n```\r\n \r\nAs no mapping is undertaken by UNDR ROVER, this file is required to determine the canonical insert sequence. Note that you will also need the .fai index file. \r\n\r\n#### Create a file specifying target regions.\r\n\r\nThe example directory contains one called `example_coords.txt`.\r\n\r\nThe file should be tab-separated, and contain information in 5 columns. The first column will contain chromosome numbers, while the second and third columns specify the starting and ending coordinates of the target regions. The fourth and fifth columns will name the forward and reverse primers of each target region. \r\n\r\nAn example of such a file is shown below:\r\n\r\n    chr11\t31811401\t31811498\tPAX6_1_F1\tPAX6_1_R1\r\n    chr11\t31811499\t31811597\tPAX6_1_F2\tPAX6_1_R2\r\n    chr11\t31812210\t31812307\tPAX6_2_F1\tPAX6_2_R1\r\n    chr11\t31812308\t31812406\tPAX6_2_F2\tPAX6_2_R2\r\n    chr11\t31812399\t31812496\tPAX6_2_F3\tPAX6_2_R3\r\n    chr11\t31814945\t31815042\tPAX6_3_F1\tPAX6_3_R1\r\n    chr11\t31815043\t31815140\tPAX6_3_F2\tPAX6_3_R2\r\n    chr11\t31815147\t31815244\tPAX6_4_F1\tPAX6_4_R1\r\n    chr11\t31815242\t31815339\tPAX6_4_F2\tPAX6_4_R2\r\n    chr11\t31815340\t31815437\tPAX6_4_F3\tPAX6_4_R3\r\n\r\nSpecify the name of this file using the `--primer_coords` command line parameter.\r\n\r\n#### Create a file specifying the primer sequences.\r\n\r\nThe example directory contains one called `example_primers.txt`\r\n\r\nUNDR ROVER requires the primer sequences for each primer in order to correctly match reads to target regions. The file should be tab-separated and simply contain 2 columns, with the first containing the primer name and the second containing the primer sequence. \r\n\r\nAn example of such a file is shown below:\r\n\r\n    PAX6_1_F1\tTAACAGCCATTTTTCTTTCTTTCCT\t\t\r\n    PAX6_1_R1\tGTGAACCTGATATGTCTCAATACT\t\t\r\n    PAX6_1_F2\tTTTTTTTTTTTACTGTAATCTTGGCC\t\t\r\n    PAX6_1_R2\tTGTCTGTTTCTCAAAGGGAATATC\t\t\r\n    PAX6_2_F1\tGAGATTCTGTTTGGGTAAACTTCT\t\t\r\n    PAX6_2_R1\tCTACACCCCCCCACATATGCA\t\t\r\n    PAX6_2_F2\tTGGCTGACTGTTCATGTGTGTC\t\t\r\n    PAX6_2_R2\tTTTGCCTCTCTCCTCACAGCC\t\t\r\n    PAX6_2_F3\tAGTATGAGGAGGTCTGGCTGG\t\t\r\n    PAX6_2_R3\tGGCATCTTTAATGATCAGACTTGT\r\n\r\nSpecify the name of this file using the `--primer_sequences` command line parameter.\r\n\r\n#### Run UNDR ROVER from the command line\r\n\r\nThe example directory contains a file called `command.sh` which contains an illustrative command to test out the program.\r\n\r\nThe command is:\r\n\r\n```\r\nundr_rover --primer_coords example_coords.txt \\\r\n           --primer_sequences example_primers.txt \\\r\n           --reference reference.fasta \\\r\n           --out example.vcf \\\r\n           --genotype \\\r\n           example_R1.fastq example_R2.fastq\r\n```\r\n\r\nThe output of the above command will be a VCF file called `example.vcf`, its contents will look like so:\r\n\r\n```\r\n##fileformat=VCFv4.2\r\n##fileDate=20160324\r\n##source=UNDR ROVER\r\n##INFO=<ID=Sample,Number=1,Type=String,Description=\"Sample Name\">\r\n##INFO=<ID=NV,Number=1,Type=Float,Description=\"Number of read pairs with variant\">\r\n##INFO=<ID=NP,Number=1,Type=Float,Description=\"Number of read pairs at POS\">\r\n##INFO=<ID=PCT,Number=1,Type=Float,Description=\"Percentage of read pairs at POS with variant\">\r\n##INFO=<ID=GT,Number=1,Type=String,Description=\"Most likely genotype of the variant\">\r\n##INFO=<ID=GTP,Number=1,Type=Float,Description=\"Probability of the genotype\">\r\n##FILTER=<ID=at,Description=\"Variant does not appear in at least 2 read pairs\">\r\n##FILTER=<ID=pt,Description=\"Variant does not appear in at least 5.0% of read pairs for the given region\">\r\n#CHROM\tPOS\tID\tREF\tALT\tQUAL\tFILTER\tINFO\r\nchr7\t152357834\t.\tT\tG\t.\tat;pt Sample=example_R1.fastq;NV=1;NP=155;PCT=0.65%;GT=TT;GTP=0.659\r\nchr7\t152357819\t.\tT\tC\t.\tPASS\tSample=example_R1.fastq;NV=76;NP=155;PCT=49.03%;GT=TC;GTP=0.957\r\n```\r\n\r\nThe VCF file contains a header region which describes the contents of the file, plus one line for each reported variant. Note that not all reported variants will be true. UNDR ROVER reports all sequence differences that it sees in the input sample which appear on both reads in a pair. It then applies stringency filters to those reported variants and annotates them in the FILTER column with PASS if they pass all stringency filters, or with annotations describing which filters they fail (`at` and `pt`). In the example above there are two reported variants, although only one of them passes the default filters (PASS). The first reported variant only appears in 1 read pair (NV=1) out of 155 read pairs which aligned to the same position. Therefore it fails two stringency tests: `at` Variant does not appear in at least 2 read pairs, and `pt` Variant does not appear in at least 5.0% of read pairs for the given region. These stringency filters are adjustable on the command line. Furthermore we can see that the reference base was T and the alternative (putative variant) base was G, however the genotype called for this position is homozygous for the reference base (GT=TT). This says that UNDR ROVER believes that the evidence in the reads for this position suggests that the reported variant G is an error. UNDR ROVER is quite confident in its reported genotype for this position (GTP=0.659). The second reported variant passes all the stringency tests and agrees with the highly confident computed genotype (GT=TC, GTP=0.957). Out of 155 read pairs for this position, the variant was observed in about half (NV=76).\r\n\r\nUNDR ROVER can accept multiple samples on the input command line. You must specify two files for each sample, corresponding to the first and second read in each pair. The read pair files for each sample must be specified consecutively. UNDR ROVER will call the variants in each sample individually, it does not perform joint genotyping.\r\n\r\nIf you have FASTQ.gz files, they will need to be decompressed. \r\n\r\nThe variants called will be written to the specified output file. This file will report called variants in accordance with the [VCF v4.2 specification](http://samtools.github.io/hts-specs/VCFv4.2.pdf). Coverage files containing the number of read-pairs which mapped to each region will be output in coverage_files/sample1.coverage and coverage_files/sample2.coverage. A log file describing the actions taken by the program will be stored in log_file.\r\n\r\n### Command line arguments\r\n\r\nUse the `-h` command line argument to get a listing of all UNDR ROVER's options:\r\n\r\n```\r\nundr_rover -h\r\n```\r\n\r\nThe above command produces the following output. A more detailed explanation of the options is provided below.\r\n\r\nMany of the command line arguments have default values.\r\n\r\n```\r\nusage: undr_rover [-h] [--version] --primer_coords PRIMER_COORDS\r\n                  --primer_sequences FILE\r\n                  [--primer_prefix_size PRIMER_PREFIX_SIZE]\r\n                  [--kmer_length KMER_LENGTH]\r\n                  [--kmer_threshold KMER_THRESHOLD]\r\n                  [--primer_bases PRIMER_BASES] [--proportionthresh N]\r\n                  [--absthresh N] [--qualthresh N] [--overlap OVERLAP]\r\n                  [--max_variants N] --reference FILE [--id_info FILE] --out\r\n                  FILE [--log FILE] [--coverdir COVERDIR] [--fast]\r\n                  [--snvthresh N] [--genotype] [--ploidy {1,2}]\r\n                  fastqs [fastqs ...]\r\n\r\nFind variants from fastqs via a mapping-free approach.\r\n\r\npositional arguments:\r\n  fastqs                Fastq files containing reads.\r\n\r\noptional arguments:\r\n  -h, --help            show this help message and exit\r\n  --version             show program's version number and exit\r\n  --primer_coords PRIMER_COORDS\r\n                        Primer coordinates in TSV format.\r\n  --primer_sequences FILE\r\n                        Primer base sequences as determined by a primer\r\n                        generating program.\r\n  --primer_prefix_size PRIMER_PREFIX_SIZE\r\n                        Size of primer key for blocks in dictionary.\r\n  --kmer_length KMER_LENGTH\r\n                        Length of k-mer to check after the primer sequence.\r\n                        Defaults to 30.\r\n  --kmer_threshold KMER_THRESHOLD\r\n                        Number of single nucleotide variants deemed acceptable\r\n                        in kmer.\r\n  --primer_bases PRIMER_BASES\r\n                        Number of bases from primer region to use in gapped\r\n                        alignment.Helps with variant calling near the edges of\r\n                        a block. Defaults to 5.\r\n  --proportionthresh N  Keep variants which appear in this proportion of the\r\n                        read pairs. For a given target region, and bin\r\n                        otherwise. Defaults to 0.05.\r\n  --absthresh N         Only keep variants which appear in at least this many\r\n                        read pairs. Defaults to 2.\r\n  --qualthresh N        Minimum base quality score (phred).\r\n  --overlap OVERLAP     Minimum proportion of block which must be overlapped\r\n                        by a read. Defaults to 0.9.\r\n  --max_variants N      Ignore reads with greater than this many variants\r\n                        observed. Defaults to 20.\r\n  --reference FILE      Reference sequences in Fasta format.\r\n  --id_info FILE        File containing rs ID information in VCF format.\r\n  --out FILE            Name of output file containing called variants.\r\n  --log FILE            Logs progress in specified file, defaults to stdout.\r\n  --coverdir COVERDIR   Directory to write coverage files, defaults to current\r\n                        working directory.\r\n  --fast                Use gapped alignment less often, leading to faster run\r\n                        time.\r\n  --snvthresh N         Distance between two single nucleotide variants before\r\n                        going to a gapped alignment.\r\n  --genotype            Compute genotypes for SNVs. Defaults to False.\r\n  --ploidy {1,2}        Ploidy for genotyping 1 = haploid, 2 = diploid.\r\n                        Defaults to 2.\r\n```\r\n\r\n### Explanation of command line options\r\n\r\n#### `-h`\r\n\r\nPrint a help message and exit.\r\n\r\n\r\n#### `--version`\r\n\r\nPrint the version number of rover and exit.\r\n\r\n\r\n#### `--primer_coords COORDS`\r\n\r\n**Required**\r\n\r\nA list of primers with their expected coordinates. TSV format with the following data:\r\n```\r\nchromosome  start   end     forward_primer  reverse_primer\r\n```\r\n\r\n\r\n#### `--primer_sequences SEQ`\r\n\r\n**Required**\r\n\r\nA list of primers with their expected base sequences. TSV format with\r\nthe following data:\r\n\r\n```\r\nprimer_name sequence\r\n```\r\n\r\n#### `--primer_prefix_size N`\r\n\r\n**Optional**. Defaults to 20. \r\n\r\nDetermines the size of the prefix used for the dictionary which stores \r\nprimers. Will most likely be set to a value equal to the minimum length \r\nof a primer. \r\n\r\n#### `--kmer_length N`\r\n\r\n**Optional**. Defaults to 30.\r\n\r\nDetermines the length of k-mer to use in k-mer test. In this \r\ntest, if a certain number of SNVs is found in k-mers from both reads\r\nthen the read pair is discarded.\r\n\r\n#### `--kmer_threshold N`\r\n\r\n**Optional**. Defaults to 2.\r\n\r\nThe number of SNVs considered acceptable in the k-mer region of a read.\r\nIf there are more than N SNVs in both k-mers of a read pair, then the \r\nread will be discarded. \r\n\r\n#### `--primer_bases N`\r\n\r\n**Optional**. Defaults to 3.\r\n\r\nWhen there are repeated bases or repeated sequences of bases near the \r\nstart of a block, detecting variants becomes slightly harder as some \r\nvariants won't be apparent. By default, UNDR ROVER will use 3 additional \r\nbases from the end of the primer region during variant calling. This will \r\nhelp to detect those variants. \r\n\r\nIncreasing the value of this parameter will mean more bases from the end \r\nof the primer region are used, leading to slightly improved accuracy at \r\nthe cost of slower run time.  \r\n\r\n#### `--proportionthresh N`\r\n\r\n**Optional**. Defaults to 0.05.\r\n\r\nOnly keep variants which appear in this proportion of the read-pairs for\r\na given target region, and bin otherwise. A variant must appear in\r\nboth reads of a pair to be counted. The proportion is calculated as\r\nfollows:\r\n\r\n  * N = number of pairs containing this variant in both reads\r\n  * T = number of read-pairs overlapping the target region\r\n\r\nproportion = N/T\r\n\r\nNote: variants must pass BOTH the proportionthresh and absthresh \r\nthresholds to be kept. If they fail either test then they are discarded.\r\n\r\nThat is to say:\r\n\r\n```\r\nif N/T  >= proportionthresh and N >= absthresh:\r\n    keep the variant\r\nelse:\r\n    discard the variant\r\n```\r\n\r\n#### `--absthresh N`\r\n\r\n**Optional**. Defaults to 2 read-pairs.\r\n\r\nOnly keep variants which appear in at least this many read-pairs\r\nfor a given target region.\r\n\r\nSee comments above about `proportionthresh`.\r\n\r\n#### `--qualthresh N`\r\n\r\n**Optional**.\r\n\r\nMinimum phred quality score for bases appearing in SNVs and\r\ninsertions. If this argument is set Rover will only consider SNVs and\r\ninsertions where all DNA bases in those variants have a quality score\r\ngreater than or equal to the argument. For example, setting this\r\nargument to 35 will cause Rover to discard any SNVs or insertions\r\ncontaining any bases with a score below 35. If the argument is not\r\nset then Rover will not consider quality scores in its decision\r\nto keep or discard a variant.\r\n\r\n#### `--overlap OVERLAP`\r\n\r\n**Optional**. Defaults to 0.9.\r\n\r\nMinimum fraction overlap of read to block region.\r\n0.5 means at least half of a block must be overlapped by a read\r\nfor the read to be considered for that region. 1.0 would mean the entire\r\nblock must be overlapped by the read.\r\n\r\n#### `--max_variants N`\r\n\r\n**Optional**. Defaults to 25. \r\n\r\nThe maximum number of variants which can be observed for a single read\r\nbefore it is considered meaningless and discarded for the purposes of\r\nvariant calling. \r\n\r\n#### `--reference FILE`\r\n\r\n**Required**.\r\n\r\nReference sequences in FASTA format. UNDR ROVER extracts insert \r\nsequences for each block from the reference and compares this with the\r\nread sequences to call variants.\r\n\r\n#### `--id_info FILE`\r\n\r\n**Optional**.\r\n\r\nUNDR ROVER will find the rs numbers in DBSNP and show them in the \r\noutput VCF file if it can find the relevant number in DBSNP, which is a \r\nvcf format file containing rs numbers for known variants in .vcf.gz \r\nformat with an accompanying .tbi file (created by tabix).\r\n\r\n#### `--fast`\r\n\r\n**Optional**. Defaults to False.\r\n\r\nIf set, gapped alignment will only be used when SNVs are detected within \r\nsnvthresh bases of each other. Leads to a significant decrease in the run \r\ntime of UNDR ROVER. \r\n\r\n#### `--snvthresh N`\r\n\r\n**Optional**. Defaults to 1.\r\n\r\nIf `--fast` is set, gapped alignment will be performed on reads\r\nwhich contain SNVs within N bases of each other. The default setting\r\nof 1 allows for the fastest run-time and should provide a sufficient \r\nlevel of accuracy in the majority of cases.\r\n     \r\n#### `--coverdir COVERDIR`\r\n\r\n**Optional**. Defaults to current working directory.\r\n\r\nDirectory to write the coverage files. If the directory does not\r\nexist Rover will not try to create it. You must create the directory\r\nyourself.\r\n\r\nThe format of the coverage files is a TSV with:\r\n\r\n```\r\nchr     block_start     block_end       num_pairs\r\n```\r\n\r\n#### `fastqs [fastqs ...]`\r\n\r\nOne or more pairs of FASTQ files containing reads for which variant\r\ncalling will be attempted. FASTQ.gz files will need to decompressed\r\nprior to use with UNDR ROVER.",
  "google": "",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}